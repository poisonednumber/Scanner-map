# Docker Compose configuration for Scanner Map
# Generated by installer on 2025-12-19T14:46:35.710Z
# 
# Services enabled:



# - rdio-scanner (Web-based Scanner) - Pull image: docker pull rdioscanner/rdio-scanner:latest


# - GPU acceleration enabled (NVIDIA)
#
# Data Persistence:
# All data is stored in ./appdata/ directory with proper volume mounts:
# - scanner-map/ - Database, audio files, logs



# - rdio-scanner/ - Config and data


#
# To remove all data: rm -rf ./appdata
# To backup: Copy ./appdata directory
#
# Note: version field removed (obsolete in newer Docker Compose versions)

services:
  scanner-map:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        TRANSCRIPTION_MODE: openai
    container_name: scanner-map
    restart: unless-stopped
    ports:
      - ${WEBSERVER_PORT:-3001}:3001
      - ${BOT_PORT:-3306}:3306
    volumes:
      - ./appdata/scanner-map/data:/app/data
      - ./appdata/scanner-map/audio:/app/audio
      - ./appdata/scanner-map/logs:/app/logs
      - ./.env:/app/.env
      - ./appdata/trunk-recorder/config:/app/appdata/trunk-recorder/config
      - ./appdata/icad-transcribe:/app/appdata/icad-transcribe
    environment:
      - NODE_ENV=production
    networks:
      - scanner-network
    healthcheck:
      test:
        - CMD
        - node
        - '-e'
        - 'require(''http'').get(''http://localhost:3001/api/test'', (r) => {process.exit(r.statusCode === 200 ? 0 : 1)})'
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
  rdio-scanner:
    image: rdioscanner/rdio-scanner:latest
    container_name: rdio-scanner
    restart: unless-stopped
    ports:
      - '3000:3000'
    volumes:
      - ./appdata/rdio-scanner/config:/app/config
      - ./appdata/rdio-scanner/data:/app/data
    environment:
      - TZ=America/New_York
    networks:
      - scanner-network
    pull_policy: missing
networks:
  scanner-network:
    driver: bridge
